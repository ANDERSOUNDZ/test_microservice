<div class="container mt-4">
  <div class="d-flex align-items-center mb-4">
    <h2 class="text-primary m-0">
      <i class="bi bi-people-fill me-2"></i>Panel de Gestión de Colaboradores
    </h2>
  </div>

  <div class="card shadow-sm border-0 mb-5 bg-white">
    <div class="card-header bg-dark text-white fw-bold">
      <i class="bi bi-person-plus me-2"></i>Registrar Nuevo Usuario en el Sistema
    </div>
    <div class="card-body p-4">
      <div class="row g-3 align-items-end">
        <div class="col-md-5">
          <label class="form-label fw-bold text-muted small">Nombre de Usuario</label>
          <div class="input-group">
            <span class="input-group-text bg-light"><i class="bi bi-at"></i></span>
            <input
              [(ngModel)]="form.username"
              class="form-control form-control-lg"
              placeholder="Ej: jperez"
            />
          </div>
        </div>
        <div class="col-md-5">
          <label class="form-label fw-bold text-muted small">Nombre Completo</label>
          <input
            [(ngModel)]="form.nombreCompleto"
            class="form-control form-control-lg"
            placeholder="Ej: Juan Pérez"
          />
        </div>
        <div class="col-md-2">
          <button
            (click)="guardar()"
            class="btn btn-success btn-lg w-100 shadow-sm fw-bold"
            [disabled]="!form.username || !form.nombreCompleto"
          >
            Guardar <i class="bi bi-save ms-1"></i>
          </button>
        </div>
      </div>

      <div class="mt-3 p-2 bg-light rounded border-start border-4 border-warning">
        <small class="text-dark">
          <i class="bi bi-exclamation-triangle-fill text-warning me-1"></i>
          <strong>Regla de Integridad:</strong> No se podrá eliminar a un colaborador si tiene
          <strong>tareas pendientes</strong> asignadas en el Panel de Distribución.
        </small>
      </div>
    </div>
  </div>

  <div class="row mb-3 align-items-center">
    <div class="col-md-8">
      <h4 class="m-0 text-secondary">Listado de Usuarios Activos</h4>
    </div>
    <div class="col-md-4 text-end">
      <span class="badge bg-primary px-3 py-2 rounded-pill shadow-sm">
        Total Personal: {{ userService.usuarios().length }}
      </span>
    </div>
  </div>

  <div class="table-responsive rounded-3 shadow-sm bg-white">
    <table class="table table-hover align-middle m-0">
      <thead class="table-light">
        <tr>
          <th class="ps-4">Nombre de Usuario</th>
          <th>Nombre Completo</th>
          <th class="text-center">Estado</th>
          <th class="text-center">Acciónes</th>
        </tr>
      </thead>
      <tbody>
        @for (user of userService.usuarios(); track user.username) {
          <tr>
            <td class="ps-4 py-3">
              <div class="fw-bold text-primary">
                {{ user.username }}
              </div>
              <small class="text-muted small">ID de red activo</small>
            </td>
            <td>
              <div class="fw-semibold text-dark">{{ user.nombreCompleto }}</div>
            </td>
            <td class="text-center">
              <span
                class="badge rounded-pill bg-success-subtle text-success border border-success-subtle px-3 py-2"
              >
                <i class="bi bi-circle-fill me-1 small"></i> ACTIVO
              </span>
            </td>
            <td class="text-center">
              <div class="btn-group">
                <button
                  (click)="editar(user)"
                  class="btn btn-sm btn-outline-primary px-3"
                  title="Editar Nombre"
                >
                  Editar
                </button>
                <button
                  (click)="eliminar(user.username)"
                  class="btn btn-sm btn-outline-danger px-3"
                  title="Eliminar Usuario"
                >
                  Eliminar
                </button>
              </div>
            </td>
          </tr>
        } @empty {
          <tr>
            <td colspan="4" class="text-center py-5">
              <div class="text-muted">
                <i class="bi bi-people fs-1 d-block mb-3 opacity-50"></i>
                <p class="h5">No se encontraron colaboradores registrados</p>
                <small>Utiliza el formulario superior para añadir personal al equipo.</small>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
